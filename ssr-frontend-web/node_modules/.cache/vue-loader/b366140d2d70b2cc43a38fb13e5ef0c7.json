{"remainingRequest":"C:\\Users\\夏海淞\\WebstormProjects\\ssr-frontend-web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\夏海淞\\WebstormProjects\\ssr-frontend-web\\src\\components\\LoginView.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\夏海淞\\WebstormProjects\\ssr-frontend-web\\src\\components\\LoginView.vue","mtime":1610608077886},{"path":"C:\\Users\\夏海淞\\WebstormProjects\\ssr-frontend-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1609653293369},{"path":"C:\\Users\\夏海淞\\WebstormProjects\\ssr-frontend-web\\node_modules\\babel-loader\\lib\\index.js","mtime":1609653295176},{"path":"C:\\Users\\夏海淞\\WebstormProjects\\ssr-frontend-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1609653293369},{"path":"C:\\Users\\夏海淞\\WebstormProjects\\ssr-frontend-web\\node_modules\\vue-loader\\lib\\index.js","mtime":1609653308845}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQoNCmV4cG9ydCBkZWZhdWx0IHsNCglkYXRhKCkgew0KCQl2YXIgY2hlY2tVaWQgPSAocnVsZSwgdmFsdWUsIGNhbGxiYWNrKSA9PiB7DQoJCQlpZiAoIXZhbHVlKSB7DQoJCQkJcmV0dXJuIGNhbGxiYWNrKG5ldyBFcnJvcign55So5oi35ZCN5LiN6IO95Li656m6JykpOw0KCQkJfQ0KCQkJcmV0dXJuIGNhbGxiYWNrKCk7DQoJCX07DQoJCXZhciB2YWxpZGF0ZVBzdyA9IChydWxlLCB2YWx1ZSwgY2FsbGJhY2spID0+IHsNCgkJCWlmICh2YWx1ZSA9PT0gJycpIHsNCgkJCQlyZXR1cm4gY2FsbGJhY2sobmV3IEVycm9yKCfor7fovpPlhaXlr4bnoIEnKSk7DQoJCQl9DQoJCQlyZXR1cm4gY2FsbGJhY2soKTsNCgkJfTsNCgkJcmV0dXJuIHsNCgkJCUxvZ2luRm9ybTogew0KCQkJCXVpZDogJycsDQoJCQkJcHN3OiAnJywNCgkJCX0sDQoJCQlydWxlczogew0KCQkJCXVpZDogW3t2YWxpZGF0b3I6IGNoZWNrVWlkLCB0cmlnZ2VyOiAnYmx1cid9XSwNCgkJCQlwc3c6IFt7dmFsaWRhdG9yOiB2YWxpZGF0ZVBzdywgdHJpZ2dlcjogJ2JsdXInfV0sDQoJCQl9DQoJCX07DQoJfSwNCgltZXRob2RzOiB7DQoJCXN1Ym1pdEZvcm0oZm9ybU5hbWUpIHsNCgkJCXRoaXMuJHJlZnNbZm9ybU5hbWVdLnZhbGlkYXRlKCh2YWxpZCkgPT4gew0KCQkJCWlmICh2YWxpZCkgew0KCQkJCQljb25zb2xlLmxvZygnc3VibWl0IScpOw0KCQkJCQlsZXQgdXJsID0gcHJvY2Vzcy5lbnYuVlVFX0FQUF9VUkwgKyAndXNlcnMvbG9naW4vJzsNCgkJCQkJLy8gbGV0IHVybCA9IHRoaXMuQkFTRV9VUkwgKyAndXNlcnMvbG9naW4vJzsNCgkJCQkJbGV0IGJhc2VNb2RlbCA9IHRoaXMuJHJlZnNbZm9ybU5hbWVdLm1vZGVsOw0KCQkJCQlsZXQgZGF0YSA9IHsNCgkJCQkJCXVzZXJuYW1lOiBiYXNlTW9kZWwudWlkLA0KCQkJCQkJcHN3OiBiYXNlTW9kZWwucHN3LA0KCQkJCQkJYXV0aDonYnVzaW5lc3MnLA0KCQkJCQl9Ow0KCQkJCQlmZXRjaCh1cmwsIHsNCgkJCQkJCWJvZHk6IEpTT04uc3RyaW5naWZ5KGRhdGEpLA0KCQkJCQkJY3JlZGVudGlhbHM6ICdpbmNsdWRlJywNCgkJCQkJCWhlYWRlcnM6IHsNCgkJCQkJCQknY29udGVudC10eXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLA0KCQkJCQkJfSwNCgkJCQkJCW1ldGhvZDogJ1BPU1QnLA0KCQkJCQkJbW9kZTogJ2NvcnMnLA0KCQkJCQl9KQ0KCQkJCQkJLnRoZW4ocmVzcCA9PiByZXNwLmpzb24oKSkNCgkJCQkJCS50aGVuKHJlc3AgPT4gew0KCQkJCQkJCWlmIChyZXNwLnN0YXR1cyA9PT0gJ29rJykgew0KCQkJCQkJCQl0aGlzLiRtZXNzYWdlKHsNCgkJCQkJCQkJCXR5cGU6ICdzdWNjZXNzJywNCgkJCQkJCQkJCW1lc3NhZ2U6ICfnmbvlvZXmiJDlip8nLA0KCQkJCQkJCQkJc2hvd0Nsb3NlOiB0cnVlDQoJCQkJCQkJCX0pOw0KCQkJCQkJCQl0aGlzLiRlbWl0KCdtZXNzYWdlJywgew0KCQkJCQkJCQkJdHlwZTogJ2xvZ2luJywNCgkJCQkJCQkJCXVpZDogYmFzZU1vZGVsLnVpZCwNCgkJCQkJCQkJfSk7DQoJCQkJCQkJCXRoaXMuJHJvdXRlci5yZXBsYWNlKCcvJyk7DQoJCQkJCQkJfSBlbHNlIHsNCgkJCQkJCQkJbGV0IHJlYXNvbiA9IHJlc3AudHlwZTsNCgkJCQkJCQkJbGV0IG1lc3NhZ2U7DQoJCQkJCQkJCXN3aXRjaCAocmVhc29uKSB7DQoJCQkJCQkJCQljYXNlICdBbHJlYWR5IGxvZ2luLic6DQoJCQkJCQkJCQkJbWVzc2FnZSA9ICfor6XotKblj7flt7LlnKjliKvlpITnmbvlvZXjgIInOw0KCQkJCQkJCQkJCWJyZWFrOw0KCQkJCQkJCQkJY2FzZSAnVXNlcm5hbWUgbm90IGV4aXN0Lic6DQoJCQkJCQkJCQkJbWVzc2FnZSA9ICfnlKjmiLflkI3kuI3lrZjlnKjmiJblr4bnoIHplJnor6/jgIInOw0KCQkJCQkJCQkJCWJyZWFrOw0KCQkJCQkJCQkJY2FzZSAnVXNlciBoYXMgbm90IGFjY29tcGxpc2hlZCBlbWFpbCBjb25maXJtYXRpb24uJzoNCgkJCQkJCQkJCQltZXNzYWdlID0gJ+eUqOaIt+WwmuacqumAmui/h+mCrueusemqjOivgeOAgic7DQoJCQkJCQkJCQkJYnJlYWs7DQoJCQkJCQkJCQljYXNlICdXcm9uZyBwYXNzd29yZC4nOg0KCQkJCQkJCQkJCW1lc3NhZ2UgPSAn55So5oi35ZCN5LiN5a2Y5Zyo5oiW5a+G56CB6ZSZ6K+v44CCJzsNCgkJCQkJCQkJCQlicmVhazsNCgkJCQkJCQkJCWRlZmF1bHQ6DQoJCQkJCQkJCQkJbWVzc2FnZSA9ICfmnKrnn6XplJnor6/jgIInOw0KCQkJCQkJCQl9DQoJCQkJCQkJCXRoaXMucmVzZXRGb3JtKGZvcm1OYW1lKTsNCgkJCQkJCQkJdGhpcy4kbWVzc2FnZSh7DQoJCQkJCQkJCQl0eXBlOiAnZXJyb3InLA0KCQkJCQkJCQkJbWVzc2FnZSwNCgkJCQkJCQkJCXNob3dDbG9zZTogdHJ1ZQ0KCQkJCQkJCQl9KTsNCgkJCQkJCQl9DQoJCQkJCQl9KQ0KCQkJCQkJLmNhdGNoKHJlYXNvbiA9PiB7DQoJCQkJCQkJY29uc29sZS5sb2coJ3JlYXNvbjonLCByZWFzb24pOw0KCQkJCQkJCXRoaXMucmVzZXRGb3JtKGZvcm1OYW1lKTsNCgkJCQkJCQl0aGlzLiRtZXNzYWdlKHsNCgkJCQkJCQkJdHlwZTogJ2Vycm9yJywNCgkJCQkJCQkJbWVzc2FnZTogJ+e9kee7nOaVhemanOaIluacjeWKoeWZqOS4jeWPr+eUqOOAgicsDQoJCQkJCQkJCXNob3dDbG9zZTogdHJ1ZQ0KCQkJCQkJCX0pOw0KCQkJCQkJfSk7DQoJCQkJfSBlbHNlIHsNCgkJCQkJLy8gY29uc29sZS5sb2coJ2Vycm9yIHN1Ym1pdCEhJyk7DQoJCQkJCXRoaXMuJG1lc3NhZ2Uoew0KCQkJCQkJdHlwZTogJ3dhcm5pbmcnLA0KCQkJCQkJc2hvd0Nsb3NlOiB0cnVlLA0KCQkJCQkJbWVzc2FnZTogJ+aCqOeahOi+k+WFpeS4jeWQiOazleOAgicNCgkJCQkJfSk7DQoJCQkJCXJldHVybiBmYWxzZTsNCgkJCQl9DQoJCQl9KTsNCgkJfSwNCgkJcmVzZXRGb3JtKGZvcm1OYW1lKSB7DQoJCQl0aGlzLiRyZWZzW2Zvcm1OYW1lXS5yZXNldEZpZWxkcygpOw0KCQl9LA0KCQloYW5kbGVSZXNldCgpIHsNCgkJCWNvbnNvbGUubG9nKCdoYW5kbGVSZXNldCcpDQoJCQl0aGlzLiRwcm9tcHQoJ+ivt+i+k+WFpeaCqOeahOeUqOaIt+WQje+8jOezu+e7n+WwhuS8mumaj+acuumHjee9ruaCqOeahOi0puWPt+eahOWvhuegge+8jOW5tuWwhuWFtuWPkemAgeWIsOaCqOeahOmCrueuseS4iu+8jOaCqOmaj+WQjuWPr+mHjeaWsOS/ruaUueWvhueggeOAglxu5oKo56Gu5a6a6KaB6YeN572u5a+G56CB5ZCX77yfJywNCgkJCQkn6K2m5ZGKJywgew0KCQkJCQljb25maXJtQnV0dG9uVGV4dDogJ+ehruWumicsDQoJCQkJCWNhbmNlbEJ1dHRvblRleHQ6ICflj5bmtognLA0KCQkJCQl0eXBlOiAnd2FybmluZycsDQoJCQkJfSkudGhlbigoe3ZhbHVlfSkgPT4gew0KCQkJCWxldCB1cmwgPSBwcm9jZXNzLmVudi5WVUVfQVBQX1VSTCArICd1c2Vycy9yZXNldC9wc3cvJzsNCgkJCQkvLyBsZXQgdXJsID0gdGhpcy5CQVNFX1VSTCArICd1c2Vycy9yZXNldC9wc3cvJzsNCgkJCQlsZXQgZGF0YSA9IHsNCgkJCQkJdXNlcm5hbWU6IHZhbHVlLA0KCQkJCQlhdXRoOididXNpbmVzcycsDQoJCQkJfTsNCgkJCQlmZXRjaCh1cmwsIHsNCgkJCQkJYm9keTogSlNPTi5zdHJpbmdpZnkoZGF0YSksDQoJCQkJCWNyZWRlbnRpYWxzOiAnaW5jbHVkZScsDQoJCQkJCWhlYWRlcnM6IHsNCgkJCQkJCSdjb250ZW50LXR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsDQoJCQkJCX0sDQoJCQkJCW1ldGhvZDogJ1BPU1QnLA0KCQkJCQltb2RlOiAnY29ycycsDQoJCQkJfSkudGhlbihyZXNwID0+IHJlc3AuanNvbigpKQ0KCQkJCQkudGhlbihyZXNwID0+IHsNCgkJCQkJCWlmIChyZXNwLnN0YXR1cyA9PT0gJ29rJykgew0KCQkJCQkJCXRoaXMuJG5vdGlmeSh7DQoJCQkJCQkJCXR5cGU6ICdzdWNjZXNzJywNCgkJCQkJCQkJdGl0bGU6ICfph43nva7miJDlip8nLA0KCQkJCQkJCQltZXNzYWdlOiAn6K+355m75b2V6YKu566x5p+l55yL5oKo55qE6YeN572u5a+G56CB44CCJw0KCQkJCQkJCX0pOw0KCQkJCQkJfSBlbHNlIHsNCgkJCQkJCQlsZXQgbWVzc2FnZTsNCgkJCQkJCQlzd2l0Y2ggKHJlc3AudHlwZSkgew0KCQkJCQkJCQljYXNlICdBbHJlYWR5IGxvZ2luLic6DQoJCQkJCQkJCQltZXNzYWdlID0gJ+ivpei0puWPt+W3sueZu+W9le+8jOaXoOazlemHjee9ruOAgic7DQoJCQkJCQkJCQlicmVhazsNCgkJCQkJCQkJY2FzZSAnVXNlcm5hbWUgbm90IGV4aXN0Lic6DQoJCQkJCQkJCQltZXNzYWdlID0gJ+eUqOaIt+WQjeS4jeWtmOWcqOOAgic7DQoJCQkJCQkJCQlicmVhazsNCgkJCQkJCQkJY2FzZSAnVGhpcyBhY2NvdW50IGhhcyBub3QgYWNjb21wbGlzaGVkIGVtYWlsIGNvbmZpcm1hdGlvbi4nOg0KCQkJCQkJCQkJbWVzc2FnZSA9ICfor6XotKblj7flsJrmnKrpgJrov4fpgq7nrrHpqozor4HjgIInOw0KCQkJCQkJCQkJYnJlYWs7DQoJCQkJCQkJCWRlZmF1bHQ6DQoJCQkJCQkJCQltZXNzYWdlID0gJ+acquefpemUmeivr+OAgic7DQoJCQkJCQkJfQ0KCQkJCQkJCXRoaXMuJG5vdGlmeSh7DQoJCQkJCQkJCXR5cGU6ICdlcnJvcicsDQoJCQkJCQkJCXRpdGxlOiAn6YeN572u5aSx6LSlJywNCgkJCQkJCQkJbWVzc2FnZSwNCgkJCQkJCQl9KTsNCgkJCQkJCX0NCgkJCQkJfSkNCgkJCX0pLmNhdGNoKCgpID0+IHsNCgkJCQl0aGlzLiRub3RpZnkuaW5mbyh7DQoJCQkJCXRpdGxlOiAn5bey5Y+W5raI6YeN572uJywNCgkJCQl9KTsNCgkJCX0pDQoJCX0NCgl9LA0KCW5hbWU6ICJMb2dpblZpZXciLA0KfQ0K"},{"version":3,"sources":["LoginView.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;AA2BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"LoginView.vue","sourceRoot":"src/components","sourcesContent":["<template>\r\n\t<div id=\"LoginView\">\r\n\t\t<el-col :span=\"8\" :offset=\"8\">\r\n\t\t\t<h1>用户登录</h1>\r\n\t\t\t<el-form\r\n\t\t\t\t:model=\"LoginForm\"\r\n\t\t\t\tstatus-icon :rules=\"rules\"\r\n\t\t\t\tref=\"LoginForm\"\r\n\t\t\t\tlabel-width=\"100px\"\r\n\t\t\t\tclass=\"demo-ruleForm\">\r\n\t\t\t\t<el-form-item label=\"用户名\" prop=\"uid\">\r\n\t\t\t\t\t<el-input v-model=\"LoginForm.uid\"></el-input>\r\n\t\t\t\t</el-form-item>\r\n\t\t\t\t<el-form-item label=\"密码\" prop=\"psw\">\r\n\t\t\t\t\t<el-input type=\"password\" v-model=\"LoginForm.psw\" autocomplete=\"off\"></el-input>\r\n\t\t\t\t</el-form-item>\r\n\t\t\t\t<el-form-item>\r\n\t\t\t\t\t<el-button type=\"primary\" @click=\"submitForm('LoginForm')\">登录</el-button>\r\n\t\t\t\t\t<el-button @click=\"resetForm('LoginForm')\">重置</el-button>\r\n\t\t\t\t\t<el-link type=\"primary\" style=\"margin-left: 15px\" @click=\"handleReset\">忘记密码？</el-link>\r\n\t\t\t\t</el-form-item>\r\n\t\t\t</el-form>\r\n\t\t</el-col>\r\n\t</div>\r\n</template>\r\n<script>\r\n\r\nexport default {\r\n\tdata() {\r\n\t\tvar checkUid = (rule, value, callback) => {\r\n\t\t\tif (!value) {\r\n\t\t\t\treturn callback(new Error('用户名不能为空'));\r\n\t\t\t}\r\n\t\t\treturn callback();\r\n\t\t};\r\n\t\tvar validatePsw = (rule, value, callback) => {\r\n\t\t\tif (value === '') {\r\n\t\t\t\treturn callback(new Error('请输入密码'));\r\n\t\t\t}\r\n\t\t\treturn callback();\r\n\t\t};\r\n\t\treturn {\r\n\t\t\tLoginForm: {\r\n\t\t\t\tuid: '',\r\n\t\t\t\tpsw: '',\r\n\t\t\t},\r\n\t\t\trules: {\r\n\t\t\t\tuid: [{validator: checkUid, trigger: 'blur'}],\r\n\t\t\t\tpsw: [{validator: validatePsw, trigger: 'blur'}],\r\n\t\t\t}\r\n\t\t};\r\n\t},\r\n\tmethods: {\r\n\t\tsubmitForm(formName) {\r\n\t\t\tthis.$refs[formName].validate((valid) => {\r\n\t\t\t\tif (valid) {\r\n\t\t\t\t\tconsole.log('submit!');\r\n\t\t\t\t\tlet url = process.env.VUE_APP_URL + 'users/login/';\r\n\t\t\t\t\t// let url = this.BASE_URL + 'users/login/';\r\n\t\t\t\t\tlet baseModel = this.$refs[formName].model;\r\n\t\t\t\t\tlet data = {\r\n\t\t\t\t\t\tusername: baseModel.uid,\r\n\t\t\t\t\t\tpsw: baseModel.psw,\r\n\t\t\t\t\t\tauth:'business',\r\n\t\t\t\t\t};\r\n\t\t\t\t\tfetch(url, {\r\n\t\t\t\t\t\tbody: JSON.stringify(data),\r\n\t\t\t\t\t\tcredentials: 'include',\r\n\t\t\t\t\t\theaders: {\r\n\t\t\t\t\t\t\t'content-type': 'application/json',\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tmethod: 'POST',\r\n\t\t\t\t\t\tmode: 'cors',\r\n\t\t\t\t\t})\r\n\t\t\t\t\t\t.then(resp => resp.json())\r\n\t\t\t\t\t\t.then(resp => {\r\n\t\t\t\t\t\t\tif (resp.status === 'ok') {\r\n\t\t\t\t\t\t\t\tthis.$message({\r\n\t\t\t\t\t\t\t\t\ttype: 'success',\r\n\t\t\t\t\t\t\t\t\tmessage: '登录成功',\r\n\t\t\t\t\t\t\t\t\tshowClose: true\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\tthis.$emit('message', {\r\n\t\t\t\t\t\t\t\t\ttype: 'login',\r\n\t\t\t\t\t\t\t\t\tuid: baseModel.uid,\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\tthis.$router.replace('/');\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tlet reason = resp.type;\r\n\t\t\t\t\t\t\t\tlet message;\r\n\t\t\t\t\t\t\t\tswitch (reason) {\r\n\t\t\t\t\t\t\t\t\tcase 'Already login.':\r\n\t\t\t\t\t\t\t\t\t\tmessage = '该账号已在别处登录。';\r\n\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\tcase 'Username not exist.':\r\n\t\t\t\t\t\t\t\t\t\tmessage = '用户名不存在或密码错误。';\r\n\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\tcase 'User has not accomplished email confirmation.':\r\n\t\t\t\t\t\t\t\t\t\tmessage = '用户尚未通过邮箱验证。';\r\n\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\tcase 'Wrong password.':\r\n\t\t\t\t\t\t\t\t\t\tmessage = '用户名不存在或密码错误。';\r\n\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t\t\t\t\tmessage = '未知错误。';\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tthis.resetForm(formName);\r\n\t\t\t\t\t\t\t\tthis.$message({\r\n\t\t\t\t\t\t\t\t\ttype: 'error',\r\n\t\t\t\t\t\t\t\t\tmessage,\r\n\t\t\t\t\t\t\t\t\tshowClose: true\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.catch(reason => {\r\n\t\t\t\t\t\t\tconsole.log('reason:', reason);\r\n\t\t\t\t\t\t\tthis.resetForm(formName);\r\n\t\t\t\t\t\t\tthis.$message({\r\n\t\t\t\t\t\t\t\ttype: 'error',\r\n\t\t\t\t\t\t\t\tmessage: '网络故障或服务器不可用。',\r\n\t\t\t\t\t\t\t\tshowClose: true\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t});\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// console.log('error submit!!');\r\n\t\t\t\t\tthis.$message({\r\n\t\t\t\t\t\ttype: 'warning',\r\n\t\t\t\t\t\tshowClose: true,\r\n\t\t\t\t\t\tmessage: '您的输入不合法。'\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\tresetForm(formName) {\r\n\t\t\tthis.$refs[formName].resetFields();\r\n\t\t},\r\n\t\thandleReset() {\r\n\t\t\tconsole.log('handleReset')\r\n\t\t\tthis.$prompt('请输入您的用户名，系统将会随机重置您的账号的密码，并将其发送到您的邮箱上，您随后可重新修改密码。\\n您确定要重置密码吗？',\r\n\t\t\t\t'警告', {\r\n\t\t\t\t\tconfirmButtonText: '确定',\r\n\t\t\t\t\tcancelButtonText: '取消',\r\n\t\t\t\t\ttype: 'warning',\r\n\t\t\t\t}).then(({value}) => {\r\n\t\t\t\tlet url = process.env.VUE_APP_URL + 'users/reset/psw/';\r\n\t\t\t\t// let url = this.BASE_URL + 'users/reset/psw/';\r\n\t\t\t\tlet data = {\r\n\t\t\t\t\tusername: value,\r\n\t\t\t\t\tauth:'business',\r\n\t\t\t\t};\r\n\t\t\t\tfetch(url, {\r\n\t\t\t\t\tbody: JSON.stringify(data),\r\n\t\t\t\t\tcredentials: 'include',\r\n\t\t\t\t\theaders: {\r\n\t\t\t\t\t\t'content-type': 'application/json',\r\n\t\t\t\t\t},\r\n\t\t\t\t\tmethod: 'POST',\r\n\t\t\t\t\tmode: 'cors',\r\n\t\t\t\t}).then(resp => resp.json())\r\n\t\t\t\t\t.then(resp => {\r\n\t\t\t\t\t\tif (resp.status === 'ok') {\r\n\t\t\t\t\t\t\tthis.$notify({\r\n\t\t\t\t\t\t\t\ttype: 'success',\r\n\t\t\t\t\t\t\t\ttitle: '重置成功',\r\n\t\t\t\t\t\t\t\tmessage: '请登录邮箱查看您的重置密码。'\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tlet message;\r\n\t\t\t\t\t\t\tswitch (resp.type) {\r\n\t\t\t\t\t\t\t\tcase 'Already login.':\r\n\t\t\t\t\t\t\t\t\tmessage = '该账号已登录，无法重置。';\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\tcase 'Username not exist.':\r\n\t\t\t\t\t\t\t\t\tmessage = '用户名不存在。';\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\tcase 'This account has not accomplished email confirmation.':\r\n\t\t\t\t\t\t\t\t\tmessage = '该账号尚未通过邮箱验证。';\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t\t\t\tmessage = '未知错误。';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tthis.$notify({\r\n\t\t\t\t\t\t\t\ttype: 'error',\r\n\t\t\t\t\t\t\t\ttitle: '重置失败',\r\n\t\t\t\t\t\t\t\tmessage,\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t}).catch(() => {\r\n\t\t\t\tthis.$notify.info({\r\n\t\t\t\t\ttitle: '已取消重置',\r\n\t\t\t\t});\r\n\t\t\t})\r\n\t\t}\r\n\t},\r\n\tname: \"LoginView\",\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n#LoginView {\r\n\tmargin-top: 10%;\r\n\ttext-align: center;\r\n}\r\n</style>"]}]}